<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generator Angka ELITE</title>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body { font-family: Arial; padding:20px; background:#f0f2f5; }
.container { background:white; padding:20px; border-radius:12px; max-width:900px; margin:auto; box-shadow:0 5px 15px rgba(0,0,0,0.1);}
button { padding:10px 18px; font-size:14px; cursor:pointer; margin:5px 5px 5px 0; border:none; border-radius:6px; }
.generate { background:#4CAF50; color:white; }
.download { background:#FF9800; color:white; }
textarea { width:100%; height:420px; margin-top:15px; font-family:monospace; }
input { padding:8px; width:100%; margin-bottom:10px; }
.info { margin-top:10px; font-size:14px; }
</style>
</head>
<body>

<div class="container">
<h2>Generator Angka ELITE ðŸ”¥ (Support Huruf + Angka)</h2>

<label>Kode Awal (contoh: 07KJ0010005 atau 07K10010005):</label>
<input type="text" id="startVal" value="07KJ0010005">

<label>Jumlah Data:</label>
<input type="number" id="jumlah" value="100">

<button class="generate" onclick="generate()">Generate</button>
<button class="download" onclick="downloadXLSX()">Download XLSX</button>

<div class="info" id="info"></div>
<textarea id="output"></textarea>
</div>

<script>

let generatedArray = [];

function splitCode(code){
    let match = code.match(/^(.*?)(\d+)$/);
    return {
        prefix: match[1],
        number: match[2]
    };
}

function padNumber(num, length){
    return num.toString().padStart(length, '0');
}

function generate(){

    let input = document.getElementById("startVal").value.trim();
    let jumlah = Number(document.getElementById("jumlah").value);

    let parts = splitCode(input);
    let prefix = parts.prefix;
    let numStr = parts.number;

    let current = parseInt(numStr);
    let length = numStr.length;

    let result = "";
    generatedArray = [];

    let startTime = Date.now();

    for(let i=1; i<=jumlah; i++){

        if(i === 1){
            let full = prefix + padNumber(current, length);
            result += full + "\n";
            generatedArray.push([full]);
            continue;
        }

        let last2 = current % 100;
        let last3 = current % 1000;
        let ribuan = Math.floor((current % 10000) / 1000);
        let lastDigit = current % 10;

        // ROLLOVER 990â€“999
        if (last3 >= 990 && last3 <= 993) {
            current += (ribuan === 4) ? 15 : 16;
        }
        else if (last3 >= 994 && last3 <= 999) {
            current += (ribuan === 4) ? 5 : 6;
        }
        // 40â€“42 â†’ +17
        else if (last2 >= 40 && last2 <= 42) {
            current += 17;
        }
        // 43â€“49 â†’ +7
        else if (last2 >= 43 && last2 <= 49) {
            current += 7;
        }
        // Last digit 0 or 1 â†’ +18
        else if (lastDigit === 0 || lastDigit === 1) {
            current += 18;
        }
        else {
            current += 8;
        }

        let full = prefix + padNumber(current, length);
        result += full + "\n";
        generatedArray.push([full]);
    }

    let endTime = Date.now();

    document.getElementById("output").value = result;
    document.getElementById("info").innerHTML =
        "Generated: <b>" + jumlah.toLocaleString() + "</b> kode | Waktu: " +
        (endTime - startTime) + " ms";
}

function downloadXLSX(){
    if(generatedArray.length === 0){
        alert("Generate dulu!");
        return;
    }
    let wb = XLSX.utils.book_new();
    let ws = XLSX.utils.aoa_to_sheet(generatedArray);
    XLSX.utils.book_append_sheet(wb, ws, "Data");
    XLSX.writeFile(wb, "Generator_Angka_ELITE.xlsx");
}

</script>

</body>
</html>